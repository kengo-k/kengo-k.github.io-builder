---
title: 'プログラミング初心者じゃないけどRustむずくない？所有権についてまとめる！'
date: '2023-06-17'
tags:
  - rust
  - programming
summary: "Rustの所有権について調べました。Rustの中で最も特徴的な要素の一つが「所有権」で、Rustプログラミングのメモリ安全性を保証する重要な概念です。今回の記事では具体例を見ながら所有権の概念を理解できるように解説してみました。Rustの所有権を正しく理解し、コードの品質と効率性を向上させていきましょう！"

thumbnail: rust
featureImage: "./top.jpg"

draft: true
---

Rustの所有権の基本tについて

次のコードを見てください。
i32をコピーするコードを掲載
```rust

```

当たり前です。では次のコードを見てみます。

structをコピーするコードを掲載
```rust

```

このコードは動きません。これがRustの通常の挙動で所有権システムによるものです。
RustにはGCがないので別の仕組みでメモリを解放する必要があります。
そのGCではないメモリ解放の仕組みが所有権システムです。

Rustではある値の所有権をただ一つの変数が持ち、その変数がスコープから外れた時にメモリを解放します。
所有権を失った変数にアクセスすることはできません。そのようなコードを書いた場合はビルドに失敗します。

なぜ所有権を持てる変数は一つだけなのか、は複数の変数が同時に所有権を持つ場合、
それらの変数がスコープから外れた時にメモリの多重解放が起きてしまうためです。
(C言語で同じメモリアドレスを2回freeしてしまうのと同じです)

最初のi32をコピーする例において、なぜビルドエラーが起きないのでしょうか？
それはプリミティブ型は所有権の移動が起こらないからです。
プリミティブ型の場合はムーブではなくコピーが起こります。
つまり同じ値を持つメモリ領域が複製される挙動となります。

Rustではデフォルトでプリミティブ型はコピーでそれ以外はムーブとなります。
ただし、明示的にCopyであると宣言することができます。

先ほどのstructをコピーする例を以下のようにします。

```rust

```

Stringはヒープに確保される。ヒープに確保されたデータは通常の所有権のシステムとは違う方法で管理されるのか？
